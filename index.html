
<!DOCTYPE html>
<html>
    <head>
        <title>OpenLayers Cookbook - Antonio Santiago</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

        <!-- Dojo -->
        <script type="text/javascript">
            // Define some Dojo configuration
            var dojoConfig = {
                async: true,
                parseOnLoad: true,
                idDebug: true
            };
        </script>
        <script src="http://ajax.googleapis.com/ajax/libs/dojo/1.8.0/dojo/dojo.js"></script>
        <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/dojo/1.8.0/dijit/themes/claro/claro.css"/>
        <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/dojo/1.8.0/dijit/themes/claro/document.css"/>

        <!-- OpenLayers -->
        <script type="text/javascript" src="http://www.acuriousanimal.com/Openlayers-Cookbook/js/OpenLayers-2.12/OpenLayers.js"></script>
        <link rel="stylesheet" href="http://www.acuriousanimal.com/Openlayers-Cookbook/js/OpenLayers-2.12/theme/default/style.css" type="text/css">

        <!-- Custom CSS -->
        <link rel="stylesheet" type="text/css" href="http://www.acuriousanimal.com/Openlayers-Cookbook/css/cookbook.css"> 

    </head>

<style>
    table.tm {
        width: 100%;
        height: 100%;
    }
    table.tm td.left, table.tm td.right {
        border: 1px solid #ccc;
        margin: 0;
        padding: 0;
    }

    table.tm td.left {
        width: 75%;
    }
    table.tm td.right {
        width: 25%;
        vertical-align: top;
        padding: 5px;
    }
    table.tb {
        border: 0;

    }
    body > table > tbody > tr > td.right > p:nth-child(1){
        font-size: 1.5em;
    }
    body > table > tbody > tr > td.right > div > p{
        font-size: 1.5em;
    }
</style>
<table class="tm">
    <tr>
        <td class="right">
            <p>Select:</p>

            <table class="tb">
                <tr>
                    <td><b>Select District:</b></td>
                    <td>
                        <select id="distSelection" data-dojo-type="dijit/form/Select" onChange="vilChange()">
                            <option value="Ambala-0">Ambala</option>
                            <option value="Bhiwani-1">Bhiwani</option>
                            <option value="Faridabad-4">Faridabad</option>
                            <option value="Fatehabad-3">Fatehabad</option>
                            <option value="Gurgaon-2">Gurgaon</option>
                            <option value="Hisar-5">Hisar</option>
                            <option value="Jhajjar-6">Jhajjar</option>
                            <option value="Jind-7">Jind</option>
                            <option value="Kaithal">Kaithal</option>
                            <option value="Karnal">Karnal</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td><b>Select Village:</b></td>
                    <td>
                        <select id="vilSelection" data-dojo-type="dijit/form/Select">
                            <option value="Ambala">Ambala</option>
                            <option value="Bharara">Bharara</option>
                            <option value="Naraingarh">Naraingarh</option>                            
                        </select>
                    </td>
                </tr>
                <tr>
                    <td><b>Select Feature:</b></td>
                    <td>
                        <select id="featureSelection" data-dojo-type="dijit/form/Select">
                            <option value="agriculture">Agriculture Land</option>
                            <option value="graveyard">Graveyard</option>
                            <option value="idgah">Idgah</option>
                            <option value="khankaha">Khankaha</option>
                            <option value="mosque">Mosque/Others</option>
                            <option value="imambara">Imambara</option>
                            <option value="pond">Pond</option>
                            <option value="madarasa">Madarasa</option>
                            <option value="plot">House/Plot</option>
                        </select>
                    </td>
                </tr>
            </table>


            <div class="tb">
                <p> Info: </p>
                <iframe id="info"></iframe>
                

            </div>

        </td>
        <td class="left">
            <div id="ch1_managing_layers" style="width: 100%; height: 500px;"></div>
        </td>
    </tr>
</table>


<!-- The magic comes here -->
<script type="text/javascript">
    
    function vilChange(){
        var gurgaon_layer = new OpenLayers.Layer.WMS("gurgaon",
                    "http://localhost:8080/geoserver/gurgaon/wms", {
                        layers: "gurgaon:Gurgaon",
                        transparent: true,
                        format: "image/png"
                    }, {
                        isBaseLayer: false,
                        buffer: 0
                    }
                );

        district = document.getElementById("distSelection").value.split('-')[0];
        index = document.getElementById("distSelection").value.split('-')[1];
        ambala = `
               <option value="Bharara">Bharara</option>
               <option value="Naraingarh">Naraingarh</option>
               <option value="Ambala">Ambala</option>
               `;
        bandhra = `
                <option value="Bandhra">Bandhra</option>
                <option value="Bhawani Kehra">Bhawani Kehra</option>
                <option value="Bhiwani">Bhiwani</option>
                <option value="Loharu">Dadri</option>
                <option value="Shiwani">Shiwani</option>
                <option value="Tosham">Tosham</option>
                `;
        gurgaon = `
                <option value="Farrukhnagar">Farrukhnagar</option>
                <option value="gurgaon">Gurgaon</option>
                <option value="Manesar">Manesar</option>
                `;                

        villages = [ambala, bandhra, gurgaon];
        if(district=='Ambala'){
            map.addLayers([ambala_layer]);
        }
        document.getElementById("vilSelection").innerHTML=villages[index];

    }

    // Create the map using the specified DOM element
    var map = new OpenLayers.Map("ch1_managing_layers", {
        allOverlays: true
    });

    // Add some OSM based layers using an array of URL sources
    var arrayOSM = ["http://otile1.mqcdn.com/tiles/1.0.0/osm/${z}/${x}/${y}.jpg",
        "http://otile2.mqcdn.com/tiles/1.0.0/osm/${z}/${x}/${y}.jpg",
        "http://otile3.mqcdn.com/tiles/1.0.0/osm/${z}/${x}/${y}.jpg",
        "http://otile4.mqcdn.com/tiles/1.0.0/osm/${z}/${x}/${y}.jpg"];
    var arrayAerial = ["http://oatile1.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.jpg",
        "http://oatile2.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.jpg",
        "http://oatile3.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.jpg",
        "http://oatile4.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.jpg"];

    var baseAerial =new OpenLayers.Layer.WMS("Global Imagery",
                    "http://maps.opengeo.org/geowebcache/service/wms", {
                        layers: "bluemarble",
                        format: "image/png8"
                    }, {
                        buffer: 0,
                        visibility: false
                    }
                );
    var baseOSM = new OpenLayers.Layer.WMS("OpenStreetMap WMS",
                    "http://ows.terrestris.de/osm/service?",
                    {layers: 'OSM-WMS'},
                    {
                        attribution: '&copy; terrestris GmbH & Co. KG <br>' +
                            'Data &copy; OpenStreetMap ' +
                            '<a href="http://www.openstreetmap.org/copyright/en"' +
                            'target="_blank">contributors<a>'
                    }
                );
    ambala_layer = new OpenLayers.Layer.WMS("Tehsils",
                    "http://localhost:8080/geoserver/harayanatehsils/wms", {
                        layers: "harayanatehsils:haryana_tehsils",
                        transparent: true,
                        format: "image/png"
                    }, {
                        isBaseLayer: false,
                        buffer: 0
                    }
                );

    info = new OpenLayers.Control.WMSGetFeatureInfo({
            url: 'http://localhost:8080/geoserver/harayanatehsils/wms', 
            title: 'Identify features by clicking',
            queryVisible: true,
            eventListeners: {
                getfeatureinfo: function(event) {                    
                    iframe = document.getElementById("info");
                    iframe.contentWindow.document.open();
                    iframe.contentWindow.document.write(event.text);
                    iframe.contentWindow.document.close();
                }
            }
        });

    map.addLayers([baseAerial, baseOSM]);

    // Add LayerSwitcher control
    map.addControl(new OpenLayers.Control.LayerSwitcher({ascending: false}));
    map.addControl(info);
    info.activate();
    // Center the view at some place
    map.setCenter(new OpenLayers.LonLat(-100, 40), 4);
        
    
</script>

</html>